!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Slardar=e()}(this,function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function r(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function c(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t}function p(t){return"object"===e(t)&&null!==t&&!f(t)}function l(t){return"function"==typeof t}function a(t){return"[object String]"===Object.prototype.toString.call(t)}function f(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(){if(!("fetch"in window))return!1;try{return new Headers,new Request(""),new Response,!0}catch(t){return!1}}function u(){return!!p(window)}function t(){return!!u()&&!!p(window.performance)}function i(){return!!t()&&!!p(window.performance.timing)}function s(){return!!t()&&!!l(window.performance.getEntries)}Array.prototype.forEach||(Array.prototype.forEach=function(t){var e,n;if(null==this)throw new TypeError("this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(1<arguments.length&&(e=arguments[1]),n=0;n<o;){var i=void 0;n in r&&(i=r[n],t.call(e,i,n,r)),n++}}),function(){if(!(window.URL&&window.URL.prototype&&"href"in window.URL.prototype)){t.prototype={toString:function(){return this.href},get href(){return this._anchorElement.href},set href(t){this._anchorElement.href=t},get protocol(){return this._anchorElement.protocol},set protocol(t){this._anchorElement.protocol=t},get host(){return this._anchorElement.host},set host(t){this._anchorElement.host=t},get hostname(){return this._anchorElement.hostname},set hostname(t){this._anchorElement.hostname=t},get port(){return this._anchorElement.port},set port(t){this._anchorElement.port=t},get pathname(){return this._anchorElement.pathname},set pathname(t){this._anchorElement.pathname=t},get search(){return this._anchorElement.search},set search(t){this._anchorElement.search=t},get hash(){return this._anchorElement.hash},set hash(t){this._anchorElement.hash=t}};var e=window.URL||window.webkitURL||window.mozURL;t.createObjectURL=function(t){return e.createObjectURL.apply(e,[t])},t.revokeObjectURL=function(t){return e.revokeObjectURL.apply(e,[t])},Object.defineProperty(t.prototype,"toString",{enumerable:!1}),window.URL=t}function t(t,e){if(!t)throw new TypeError("Invalid argument");var n=document.implementation.createHTMLDocument("");if(e){var r=n.createElement("base");r.href=e,n.head.appendChild(r)}var o=n.createElement("a");if(o.href=t,n.body.appendChild(o),":"===o.protocol||!/:/.test(o.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:o})}}(),function(){if(!Element.prototype.addEventListener){var a=[],t=function(t,e){function n(t){t.target=t.srcElement,t.currentTarget=r,void 0!==e.handleEvent?e.handleEvent(t):e.call(r,t)}var r=this;if("DOMContentLoaded"===t){var o=function(t){"complete"===document.readyState&&n(t)};if(document.attachEvent("onreadystatechange",o),a.push({object:this,type:t,listener:e,wrapper:o}),"complete"===document.readyState){var i=new Event;i.srcElement=window,o(i)}}else this.attachEvent("on"+t,n),a.push({object:this,type:t,listener:e,wrapper:n})},e=function(t,e){for(var n=0;n<a.length;){var r=a[n];if(r.object===this&&r.type===t&&r.listener===e){"DOMContentLoaded"===t?this.detachEvent("onreadystatechange",r.wrapper):this.detachEvent("on"+t,r.wrapper),a.splice(n,1);break}++n}};Element.prototype.addEventListener=t,Element.prototype.removeEventListener=e,HTMLDocument&&!HTMLDocument.prototype.addEventListener&&(HTMLDocument.prototype.addEventListener=t,HTMLDocument.prototype.removeEventListener=e),Window&&!Window.prototype.addEventListener&&(Window.prototype.addEventListener=t,Window.prototype.removeEventListener=e)}}();var d=(m.prototype._send=function(t){},m.prototype.setupTransport=function(t){var e=this;this._transport=t,this._sendQueue.forEach(function(t){e._sendEvent(t)}),this._sendQueue=[]},m);function m(t){var n=this;this._setupMonitors=function(t){return t.forEach(function(t){t.setup(n._sendEvent)}),t},this._sendEvent=function(t){if(n._transport){var e=n._modifyEvent(t);n._shouldSend(e)&&n._idleSendEvent(e)}else n._sendQueue.push(t)},this._modifyEvent=function(t){return t},this._shouldSend=function(t){return!0},this._getIdle=function(){return l(window.requestIdleCallback)?window.requestIdleCallback:l(setTimeout)?setTimeout:function(t){t()}},this._idleSendEvent=function(t){n._getIdle()(function(){n._send(t)})},this._options=t,this._sendQueue=[],this._monitors=this._setupMonitors(t.defaultMonitors||[])}function _(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function v(t,e){var n,r;if(function(t){return void 0===t}(t.length))for(n in t)_(t,n)&&e.call(null,n,t[n]);else if(r=t.length)for(n=0;n<r;n++)e.call(null,n,t[n])}function g(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n={},r=0;r<t.length;)n=w(n,t[r]),r++;return n}function w(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&void 0!==e[n]&&(p(t[n])&&p(e[n])?w(t[n],e[n]):!p(t[n])&&p(e[n])?t[n]=w({},e[n]):t[n]=e[n]);return t}function y(t,e){if(!f(t))return!1;if(0===t.length)return!1;for(var n=0;n<t.length;){if(t[n]===e)return!0;n++}return!1}function S(t){var e=function(t){var n={};return v(t,function(t,e){n[encodeURIComponent(t)]=encodeURIComponent(e)}),n}(function(t){var n={};return v(t,function(t,e){p(e)||f(e)?n[t]=JSON.stringify(e):n[t]=e}),n}(t)),n=[];return v(e,function(t,e){n.push(t+"="+e)}),n.join("&")}function b(t){var e=document.createElement("a");e.href=t;var n=e.pathname||"/";return"/"!==n[0]&&(n="/"+n),{protocol:e.protocol.slice(0,-1),hostname:e.hostname,host:e.host,pathname:n}}function E(t){}function P(t){return l(t)?t:E}function L(t){"complete"!==document.readyState?window.addEventListener("load",function(){setTimeout(function(){t()},0)},!1):t()}function C(t){if(!t)return"";var e=[];return t.forEach(function(t){e.push(t[0]+": "+t[1])}),e.join("\r\n")}function k(t){var e={},n=b(t);return e.ax_protocol=n.protocol,e.ax_domain=n.hostname,e.ax_path=n.pathname,e.ax_url=t,e}function M(t){return f(t)&&t.length?function(t){for(var e=[],n=t.length,r=0;r<n;r++){var o=t[r];a(o)?e.push(o.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):o&&o.source&&e.push(o.source)}return new RegExp(e.join("|"),"i")}(t):null}var j,x=["/log/sentry/"],R="i.snssdk.com",H=((j=function(){for(var t=new Array(16),e=0,n=void 0;e<16;e++)0==(3&e)&&(n=4294967296*Math.random()),t[e]=n>>>((3&e)<<3)&255;return t}())[6]=15&j[6]|64,j[8]=63&j[8]|128,function(t){for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);var r=0,o=e;return[o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]]].join("")}(j)),T=(A.prototype.postEvent=function(t){var e=h(h({},t),this._getCommonParams());A.post(this._url,e)},A.prototype.getEvent=function(t){var e=S(h(h({},t),this._getCommonParams())),n=this._url+"?"+e;A.get(n)},A.prototype.setCommonParams=function(t){this._commonParams=g({},this._commonParams,t)},A.post=function(t,e,n){var r=n?P(n.success):E,o=n?P(n.fail):E,i=new XMLHttpRequest;i.open("POST",t,!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(e)),i.addEventListener("load",function(){try{var t=JSON.parse(this.responseText);r(t)}catch(t){o()}}),i.addEventListener("error",function(){o()}),i.addEventListener("abort",function(){o()})},A.get=function(t,e){var n=e?P(e.success):E,r=e?P(e.fail):E,o=new XMLHttpRequest;o.open("GET",t),o.send(),o.addEventListener("load",function(){try{var t=JSON.parse(this.responseText);n(t)}catch(t){r()}}),o.addEventListener("error",function(){r()}),o.addEventListener("abort",function(){r()})},A.prototype._getUrl=function(){return"https://"+(this._commonParams.report_domain||R)+"/log/sentry/v2/api/slardar/main/"},A.prototype._getCommonParams=function(){return h(h({},this._commonParams),{timestamp:Date.now()})},A.prototype.updateConfig=function(t){this._commonParams=g({},this._commonParams,t.commonParams||{})},A);function A(t){this._commonParams=t.sendCommonParams||t.commonParams||{},this._url=this._getUrl()}var q,O,U,D=(n(q=X,O=U=d),void(q.prototype=null===O?Object.create(O):(F.prototype=O.prototype,new F)),X.prototype.setupTransport=function(){var t=new T(this._options);U.prototype.setupTransport.call(this,t)},X.prototype._send=function(t){l(this._options.custom.beforeSend)&&(t.event=this._options.custom.beforeSend(t.event),!t.event)||("get"!==t.type?"post"!==t.type||this._transport.postEvent(t.event):this._transport.getEvent(t.event))},X.prototype._sendPageview=function(){this._sendEvent({name:"PageView",type:"get",event:{ev_type:"pageview"}})},X);function F(){this.constructor=q}function X(t){var u=U.call(this,t)||this;return u._shouldSend=function(t){var e=t.name,n=t.event;if(!t.event)return!1;if("AjaxMonitor"===e||"FetchMonitor"===e){var r,o=u._options.monitors.AjaxMonitor.whitelistUrls;if(f(o)&&0<o.length){var i=M(u._options.monitors.AjaxMonitor.whitelistUrls||[]);return!(!i||!i.test(n.ax_url))}if((r=M(u._options.monitors.AjaxMonitor.ignore||[]))&&r.test(n.ax_url))return!1;if(!u._options.monitors.AjaxMonitor.hookFetch)return!1}if("StaticErrorMonitor"===e&&((r=M(u._options.monitors.StaticErrorMonitor.ignore||[]))&&r.test(n.st_url)))return!1;if("PathMonitor"!==e)return"HijackMonitor"!==e||Math.random()<u._options.monitors.HijackMonitor.sampleRate;var a=u._options.plugins;return!!(a&&a.spa&&a.spa.enable&&n.type===a.spa.type)},u._modifyEvent=function(t){var e=t.name,n=t.type,r=t.event,o=h({},r);if("PerformanceMonitor"!==e)return"PathMonitor"===e?(u._options.plugins.spa.enable&&u._options.plugins.spa.type===o.type&&(u.updateConfig({commonParams:{pid:o.path}}),delete o.type,delete o.path),{}):t;var i=window.performance.timing,a=u._options.monitors.PerformanceMonitor,s=i.loadEventEnd-i.navigationStart>a.slowSessionTime;if(o.resources&&f(o.resources)){var c=M(u._options.monitors.PerformanceMonitor.geckoUrls||[]);v(o.resources,function(t,e){p(o.resources[t])&&l(o.resources[t].toJSON)&&(o.resources[t]=o.resources[t].toJSON(),o.resources[t].is_gecko=c&&c.test(e.name||"")?"1":"0")})}return Math.random()<a.resourceSampleRate?o=h(h({},o),{upload_reason:"sample",resource_samplerate:u._options.monitors.PerformanceMonitor.resourceSampleRate}):s?o=h(h({},o),{upload_reason:"slow_session"}):delete o.resources,{name:e,type:n,event:o}},u.updateConfig=function(t){var e=u._options.commonParams.pid;u._options=g({},u._options,t),p(u._options.commonParams.context)&&(u._options.commonParams.context=JSON.stringify(u._options.commonParams.context)),u._transport&&u._transport.updateConfig(u._options),t.commonParams.pid!==e&&u._sendPageview()},u.sendCustomTimeLog=function(t,e,n){!function(t,e){var n=t.name,r=t.tag,o=t.value;if(n){var i={ev_type:"custom",cm_name:n,cm_type:"time",cm_value:+o};r&&(i.cm_tag=r),e({name:"SentCustomTime",type:"get",event:i})}}({name:t,tag:e,value:n},u._sendEvent)},u.sendCustomCountLog=function(t,e){!function(t,e){var n=t.name,r=t.tag;if(n){var o={ev_type:"custom",cm_name:n,cm_type:"count"};r&&(o.cm_tag=r),e({name:"SentCustomCount",type:"get",event:o})}}({name:t,tag:e},u._sendEvent)},u._sendPageview(),u}var I=function(){var i=this;this.name="StaticErrorMonitor",this.setup=function(t){u()&&(i._callback=t,window.addEventListener("error",i._staticErrorLog,!0))},this._getParams=function(t,e){var n={ev_type:"static",st_type:e},r=b(t);return n.st_src=t,n.st_protocol=r.protocol,n.st_domain=r.hostname,n.st_path=r.pathname,n},this.getSrc=function(t){return t&&l(t.getAttribute)?t.getAttribute("src"):t.src||t.href||""},this._staticErrorLog=function(t){var e,n=t||window.event||{};try{e=n.target||n.srcElement||{}}catch(n){return}var r=i.getSrc(e),o=e.tagName&&e.tagName.toLowerCase()||"";r&&o&&r!==window.location.href&&i._callback&&i._callback({name:i.name,type:"get",event:i._getParams(r,o)})}},z=(W.prototype.setup=function(t){l(XMLHttpRequest)&&(this._callback=t,this._start())},W.prototype._hookXMLHttpRequestOnreadystatechange=function(r){var o=this.onreadystatechange,i=this;this.onreadystatechange=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(4===this.readyState){var n={ev_type:"ajax",ax_status:this.status,ax_type:i._method,ax_request_header:C(i._requestHeaders||[])};n.ax_duration=Date.now()-i._start,200===this.status&&(n.ax_size=function(t){var e=0;if(""===t.responseType||"text"===t.responseType)e=B(t.responseText);else if(t.response)e=B(t.response);else try{e=B(t.responseText)}catch(t){e=0}return e}(this)),"function"==typeof this.getAllResponseHeaders&&(n.ax_response_header=this.getAllResponseHeaders()),n=h(h({},n),k(i._url)),r._callback({name:r.name,type:"get",event:n})}if(o)return o.apply(this,t)}},W);function W(){var t=this;this.name="AjaxMonitor",this._start=function(){t._hookXMLHttpRequestOpen(),t._hookXMLHttpRequestSend(),t._hookXMLHttpRequestSetRequestHeader()},this._hookXMLHttpRequestSetRequestHeader=function(){var n=XMLHttpRequest.prototype.setRequestHeader;XMLHttpRequest.prototype.setRequestHeader=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._requestHeaders=this._requestHeaders||[],this._requestHeaders.push(t),n.apply(this,t)}},this._hookXMLHttpRequestOpen=function(){var o=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=t[1];return this._url=r&&r.split("?")[0]||"",this._method=n&&n.toLowerCase()||"",o.apply(this,t)}},this._hookXMLHttpRequestSend=function(){var n=t,r=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n._hookXMLHttpRequestOnreadystatechange.call(this,n),this._start=Date.now(),r.apply(this,t)}}}function B(t){var e="[object String]"===Object.prototype.toString.call(t);return t?e?t.length:ArrayBuffer&&t instanceof ArrayBuffer?t.byteLength:window.Blob&&t instanceof Blob?t.size:t.length?t.length:0:0}var N=function(){var c=this;this.name="FetchMonitor",this.setup=function(t){o()&&(c._callback=t,c._start())},this._start=function(){o()&&c._hookFetch()},this._hookFetch=function(){var a=c,s=window.fetch;window.fetch=function(e,n){n=n||{};var r=Date.now(),o={ev_type:"ajax"},t=c._getFetchUrl(e),i=c._getFetchMethod(e);return o.ax_type=(n.method||i).toLowerCase(),o=h(h({},o),k(t)),s(e,n).then(function(t){return o.ax_status=t.status,o.ax_duration=Date.now()-r,o.ax_response_header=a._getAllResponseHeaders(t),o.ax_request_header=a._getFetchHeaders(e,n),t.headers&&l(t.headers.has)&&t.headers.has("content-length")?o.ax_size=Number(t.headers.get("content-length"))||0:o.ax_size=0,a._callback({name:a.name,type:"get",event:o}),t},function(t){return o.ax_status=0,o.ax_size=0,o.ax_duration=Date.now()-r,a._callback({name:a.name,type:"get",event:o}),Promise.reject(t)})}},this._getFetchUrl=function(t){var e="";return e=a(e=t instanceof Request?t.url:t)?e.split("?")[0]:e},this._getFetchMethod=function(t){var e="get";return t instanceof Request&&(e=t.method),e},this._getFetchHeaders=function(t,e){var n="";if(t instanceof Request)return n=c._getAllResponseHeaders(t);if(e&&e.headers){if(e.headers instanceof Headers)return n=c._getAllResponseHeaders(e);if(e.headers instanceof Array)return n=C(e.headers);if(e.headers instanceof Object){var r=[];for(var o in e.headers)Object.prototype.hasOwnProperty.call(e.headers,o)&&r.push([o,e.headers[o]]);return n=C(r)}}return n},this._getAllResponseHeaders=function(t){if(!t||!t.headers||"function"!=typeof t.headers.forEach)return"";var n=[];return t.headers.forEach(function(t,e){n.push(e+": "+t)}),n.join("\r\n")}},J=[],Q=function(){var e=this;this.name="StaticPerformanceMonitor",this.setup=function(t){s()&&(e._callback=t,L(function(){return e._sendPerformance()}))},this._sendPerformance=function(){if(s()){var t=e._getParams();e._callback({name:e.name,event:t})}},this._getParams=function(){return{resources:e._getResources()}},this._getResources=function(){return s()?window.performance.getEntriesByType("resource").filter(function(t){return!y(J,t.initiatorType)}):[]}},$=0,G=["ms","moz","webkit","o"];var V={getRaf:function(){for(var t=window.requestAnimationFrame,e=0;e<G.length&&!t;++e)t=window[G[e]+"RequestAnimationFrame"];return t=t||function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-$)),r=window.setTimeout(function(){t(e+n)},n);return $=e+n,r}},getCaf:function(){for(var t=window.cancelAnimationFrame,e=0;e<G.length&&!t;++e)t=window[G[e]+"CancelAnimationFrame"]||window[G[e]+"CancelRequestAnimationFrame"];return t=t||function(t){clearTimeout(t)}}},K=function(){var e=this;this.name="FirstScreenMonitor",this.setup=function(t){u()&&(e._callback=t,e._start())},this._start=function(){var o,i=V.getRaf(),a=V.getCaf(),s=!1,c=(window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:0)||0,u=[],h=!1,p=!1,l=e;function f(){var t,e;if(h){if(u.length&&!p)for(t=0;t<u.length;t++){if(!(e=u[t]).complete){p=!1;break}p=!0}else p=!0;if(p)return s||(s=!0,l._callback({time:Date.now()})),void a(o)}else{var n=document.querySelectorAll("img");for(t=0;t<n.length;t++){var r=Y(e=n[t]);if(c<r){h=!0;break}r<=c&&!e.hasPushed&&(e.hasPushed=1,u.push(e))}}o=i(f)}if(o=i(f),"complete"===document.readyState)return h=p=!0,a(o),void f();document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("img").length||(h=!0,a(o),f())}),window.addEventListener("load",function(){h=p=!0,a(o),f()},!1)}};function Y(t){if(!t)return 0;var e=t.offsetTop;return t.offsetParent&&(e+=Y(t.offsetParent)),e}var Z=function(){var o=this;this.name="PerformanceMonitor",this.setup=function(t){i()&&(o._callback=t,o._sendParams={ev_type:"perf",has_resource:0},L(function(){return o._perfLog()}),(new Q).setup(o._hasResource),(new K).setup(o._hasFirstScreen))},this._hasResource=function(t){o._sendParams=h(h(h({},o._sendParams),t.event),{has_resource:1})},this._hasFirstScreen=function(t){i()&&(o._sendParams.firstscreen=t.time-window.performance.timing.navigationStart)},this._getParams=function(){if(i()){var t={},e=window.performance.timing;t.dns=e.domainLookupEnd-e.domainLookupStart,t.tcp=e.connectEnd-e.connectStart,t.request=e.responseStart-e.requestStart,t.response=e.responseEnd-e.responseStart,t.processing=e.domComplete-e.domLoading,t.blank=e.responseEnd-e.navigationStart,t.domready=e.domInteractive-e.navigationStart,t.load=e.loadEventEnd-e.navigationStart,e.secureConnectionStart&&(t.ssl=e.connectEnd-e.secureConnectionStart),t.domparse=e.domInteractive-e.responseEnd,t.resource=e.loadEventStart-e.domContentLoadedEventEnd,t.ttfb=e.responseStart-e.requestStart,t.redirct=e.redirectEnd-e.redirectStart;var n=o._getPaintTime("first-paint"),r=o._getPaintTime("first-contentful-paint");return n&&(t.fp=Math.round(n)),r&&(t.fcp=Math.round(r)),t.navigation=function(){if(!s())return window.performance.timing;var t=window.performance.getEntriesByType("navigation");return f(t)&&0!==t.length?t[0]:window.performance.timing}(),t}},this._getPaintTime=function(e){if(s()){var t=performance.getEntriesByType("paint");if(f(t)){var n=t.filter(function(t){return t.name===e});return 0===n.length?0:n[0].startTime}}return 0},this._perfLog=function(){setTimeout(function(){i()&&(o._sendParams=h(h({},o._sendParams),o._getParams()),o._sendParams.firstscreen||(o._sendParams.firstscreen=o._sendParams.domready),o._callback({name:o.name,type:"post",event:o._sendParams}))},0)}};var tt=function(){var i=this;this.name="PathMonitor",this.setup=function(t){u()&&(i._callback=t,i._start())},this._start=function(){i._monitorHashChange(),u()&&p(window.history)&&l(window.history.pushState)&&l(window.history.replaceState)&&(i._monitorPushState(),i._monitorReplaceState())},this._monitorHashChange=function(){window.addEventListener("hashchange",function(){var t=i._parseHash(location.hash);t&&i._pathChangeHandler(i._getPath(t),"hash")})},this._monitorPushState=function(){var n=i,r=window.history.pushState;r&&(window.history.pushState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n._handleHistoryStateChange.apply(n,c(t)),r.apply(this,t)})},this._monitorReplaceState=function(){var n=i,r=window.history.replaceState;r&&(window.history.replaceState=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n._handleHistoryStateChange.apply(n,c(t)),r.apply(this,t)})},this._pathChangeHandler=function(t,e){a(t)&&i._callback({name:i.name,type:"get",event:{ev_type:"pageview",path:t,type:e}})},this._handleHistoryStateChange=function(t,e,n){var r=i._parseURL(n),o=i._parseURL(location.href);r&&o&&(r.pathname===o.pathname?r.hash===o.hash||i._pathChangeHandler(i._getPath(o.hash),"hash"):i._pathChangeHandler(i._getPath(r.pathname),"pathname"))},this._parseURL=function(t){if(!t)return null;if("string"!=typeof t)return null;if(t.match(/^\/[^\/]/))return new URL(location.protocol+"//"+location.host+t);try{return new URL(t)}catch(t){return null}},this._parseHash=function(t){return t?"string"!=typeof t?"":t.replace(/^#/,""):""},this._getPath=function(t){var e=t&&"string"==typeof t?t.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):"";return e=i._parseHash(e)}},et=M(["bytecdn.cn","pstatp.com","snssdk.com","toutiao.com","365yg.com","byted.org"]),nt=(rt.prototype._sendHijackEvent=function(){this._callback({name:this.name,type:"post",event:{ev_type:"hijack",events:this._events}})},rt);function rt(){var c=this;this.name="HijackMonitor",this.setup=function(t){u()&&(c._callback=t,c._start())},this._start=function(){L(function(){setTimeout(function(){c._antiHijack()},2e3)})},this._antiHijack=function(){c._checkScripts(),c._checkIframe(),c._sendHijackEvent()},this._checkScripts=function(){for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var n=t[e],r=b(n.src);n.src?c._inWhiteListDomain(r.hostname)||c._events.push({hijack_type:"script",hijack_host:r.host,hijack_content:n.src}):c._inWhiteListContent(n.innerHTML)||c._events.push({hijack_type:"script",hijack_host:"unknown",hijack_content:n.innerHTML})}},this._checkIframe=function(){for(var t=document.getElementsByTagName("iframe"),e=0,n=t.length;e<n;e++){var r=t[e],o=r.src,i="about:blank";if(o&&o!==i){var a=b(o);0===a.protocol.indexOf("http")&&a.hostname&&c._inWhiteListIframeDomain(a.hostname)&&c._events.push({hijack_type:"iframe",hijack_host:a.host,hijack_content:o})}else if(o===i){var s="";try{r.contentDocument&&r.contentDocument.body&&r.contentDocument.body.innerHTML&&(s=r.contentDocument.body.innerHTML)}catch(t){s="Access is denied"}s&&c._events.push({hijack_type:"iframe",hijack_host:i,hijack_content:s})}}},this._inWhiteListDomain=function(t){return!(!et||!et.test(t))},this._inWhiteListContent=function(t){return!1},this._inWhiteListIframeDomain=function(t){return c._inWhiteListDomain(t)},this._events=[]}var ot=Object.prototype.hasOwnProperty,it="~";function at(){}function st(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function ct(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var i=new st(n,r||t,o),a=it?it+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],i]:t._events[a].push(i):(t._events[a]=i,t._eventsCount++),t}function ut(t,e){0==--t._eventsCount?t._events=new at:delete t._events[e]}function ht(){this._events=new at,this._eventsCount=0}Object.create&&(at.prototype=Object.create(null),(new at).__proto__||(it=!1)),ht.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)ot.call(t,e)&&n.push(it?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},ht.prototype.listeners=function(t){var e=it?it+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,i=new Array(o);r<o;r++)i[r]=n[r].fn;return i},ht.prototype.listenerCount=function(t){var e=it?it+t:t,n=this._events[e];return n?n.fn?1:n.length:0},ht.prototype.emit=function(t,e,n,r,o,i){var a=it?it+t:t;if(!this._events[a])return!1;var s,c,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,r),!0;case 5:return u.fn.call(u.context,e,n,r,o),!0;case 6:return u.fn.call(u.context,e,n,r,o,i),!0}for(c=1,s=new Array(h-1);c<h;c++)s[c-1]=arguments[c];u.fn.apply(u.context,s)}else{var p,l=u.length;for(c=0;c<l;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,n);break;case 4:u[c].fn.call(u[c].context,e,n,r);break;default:if(!s)for(p=1,s=new Array(h-1);p<h;p++)s[p-1]=arguments[p];u[c].fn.apply(u[c].context,s)}}return!0},ht.prototype.on=function(t,e,n){return ct(this,t,e,n,!1)},ht.prototype.once=function(t,e,n){return ct(this,t,e,n,!0)},ht.prototype.removeListener=function(t,e,n,r){var o=it?it+t:t;if(!this._events[o])return this;if(!e)return ut(this,o),this;var i=this._events[o];if(i.fn)i.fn!==e||r&&!i.once||n&&i.context!==n||ut(this,o);else{for(var a=0,s=[],c=i.length;a<c;a++)(i[a].fn!==e||r&&!i[a].once||n&&i[a].context!==n)&&s.push(i[a]);s.length?this._events[o]=1===s.length?s[0]:s:ut(this,o)}return this},ht.prototype.removeAllListeners=function(t){var e;return t?(e=it?it+t:t,this._events[e]&&ut(this,e)):(this._events=new at,this._eventsCount=0),this},ht.prototype.off=ht.prototype.removeListener,ht.prototype.addListener=ht.prototype.on,ht.prefixed=it;var pt=new(ht.EventEmitter=ht),lt=function(){var s=this;this.version="2.1.2",this._setBaseParams=function(){s.baseParams.bid=s.shared.config.commonParams.bid||"",s.baseParams.pid=s.shared.config.commonParams.pid||""},this.instance=function(){for(var t,e,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=n[0],i=n.slice(1);if("config"!==o)s._client&&("send"!==o?"sendCustomCountLog"!==o?"sendCustomTimeLog"!==o?"Sentry"===o&&l(i[0])&&(window.Sentry?i[0](window.Sentry):s.shared.collect.Sentry.push(i[0])):(e=s._client).sendCustomTimeLog.apply(e,c(i)):(t=s._client).sendCustomCountLog.apply(t,c(i)):s._send(i));else{s._configSetting=i[0];var a=s._normalizeSetting(i[0]);s._client?s._client.updateConfig(a):s._init(a)}},this._init=function(t){var e=[new I,new Z,new tt,new nt];e.push(new z),e.push(new N);var n=h(h({},t),{defaultMonitors:e});s._client=new D(n),s.shared.instance.push(n.commonParams.bid),s._getServerSetting(n.commonParams.bid)},this._send=function(t){if("count"===t[0]){var e=t[1],n=e.category,r=e.action;s._client.sendCustomCountLog(n,r)}if("timing"===t[0]){var o=t[1],i=(n=o.category,r=o.action,o.value);s._client.sendCustomTimeLog(n,r,i)}},this._getServerSetting=function(t){var e=s._serverSetting;if(e){var n=s._normalizeSetting(e);s._initServerSetting(n)}else{var r="https://"+(s._baseClientConfig.commonParams.report_domain||R)+"/slardar/sdk_setting?bid="+t;T.get(r,{success:function(t){try{var e=s._normalizeSetting(t.data);s._initServerSetting(e)}catch(t){s._initServerSetting(s._baseClientConfig)}},fail:function(){s._initServerSetting(s._baseClientConfig)}})}},this._initServerSetting=function(t){var e=s._normalizeSetting(t);s._client.updateConfig(e),Math.random()<e.commonParams.sample_rate&&(s._client.setupTransport(),s.shared.transport=s._client._transport),s._setCookie(e.commonParams.slardar_web_id),s.shared.emitter.emit("pluginsReady",e)},this._setCookie=function(t){t&&(document.cookie="SLARDAR_WEB_ID="+t+";max-age=7776000;domain="+location.hostname+";path=/")},this._normalizeSetting=function(t){void 0===t&&(t=s._baseClientConfig);var e=s._getClientCommonParams(t),n=s._getClientMonitorsSetting(t),r=s._getClientPluginsSetting(t),o=s._getClientCustom(t),i=g(s._baseClientConfig,{commonParams:e,plugins:r,monitors:n,custom:o},{commonParams:t.commonParams||{},plugins:t.plugins||{},monitors:t.monitors||{},custom:t.custom||{}},{commonParams:s._getClientCommonParams(s._configSetting),plugins:s._getClientPluginsSetting(s._configSetting),monitors:s._getClientMonitorsSetting(s._configSetting),custom:s._getClientCustom(s._configSetting)});return s.shared.config=i,s._setBaseParams(),s._baseClientConfig=i},this._getClientCommonParams=function(t){var n={},r=["bid","context","pid","sample_rate","slardar_session_id","slardar_web_id"];return v(t,function(t,e){y(r,t)&&(n[t]=e)}),t.cookieid&&(n.slardar_web_id=t.cookieid),t.sampleRate&&(n.sample_rate=t.sampleRate),t.reportDomain&&(n.report_domain=t.reportDomain),t.domain&&(n.report_domain=t.domain),n.slardar_web_id&&(n.slardar_web_id=n.slardar_web_id.toString()),n},this._getClientCustom=function(t){var e={};return l(t.beforeSend)&&(e.beforeSend=t.beforeSend),e},this._getClientMonitorsSetting=function(t){var e=h(h({},s._baseClientConfig.monitors),t.monitors||{});return t.ajaxWhitelistUrls&&(e.AjaxMonitor=h(h({},e.AjaxMonitor),{whitelistUrls:e.AjaxMonitor.whitelistUrls.concat(f(t.ajaxWhitelistUrls)?t.ajaxWhitelistUrls:[])})),t.ignoreAjax&&(e.AjaxMonitor=h(h({},e.AjaxMonitor),{ignore:e.AjaxMonitor.ignore.concat(f(t.ignoreAjax)?t.ignoreAjax:[])})),_(t,"hookFetch")&&(e.AjaxMonitor=h(h({},e.AjaxMonitor),{hookFetch:t.hookFetch})),_(t,"enableSizeStats")&&(e.AjaxMonitor=h(h({},e.AjaxMonitor),{hookFetch:t.hookFetch})),_(t,"geckoUrls")&&(e.PerformanceMonitor={geckoUrls:t.geckoUrls}),t.ignoreList&&(e.StaticErrorMonitor=h(h({},e.StaticErrorMonitor),{ignore:e.StaticErrorMonitor.ignore.concat(f(t.ignoreList)?t.ignoreList:[])})),e},this._getClientPluginsSetting=function(t){return t.plugins||{}},this._baseClientConfig={defaultMonitors:[],commonParams:{version:this.version,hostname:window.location.hostname,protocol:window.location.protocol.slice(0,-1),url:window.location.href,slardar_session_id:H,sample_rate:1,pid:location.pathname,report_domain:R,screen_resolution:u()&&window.screen&&window.screen.width&&window.screen.height?window.screen.width+"x"+window.screen.height:"0x0",network_type:function(){var t="unknown",e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return e&&a(e.effectiveType)?e.effectiveType:t}(),bid:"",context:{},slardar_web_id:""},monitors:{AjaxMonitor:{ignore:x,hookFetch:!0,enableSizeStats:!1,abort:!1,whitelistUrls:[]},StaticErrorMonitor:{ignore:x},PerformanceMonitor:{resourceSampleRate:.1,slowSessionTime:8e3,geckoUrls:[],interval:0,checkPoint:[]},HijackMonitor:{sampleRate:.1}},plugins:{spa:{enable:0,type:""},behavior:{enable:0,slardar_web_ids:[],sample_rate:0,patterns:[],download_link:""},sentry:{enable:0,behavior_enable:!1,behavior_sample_rate:0,behavior_slardar_web_ids:[],download_link:"",tags:{}}},custom:{beforeSend:function(t){return t}}},this._client=void 0,this._configSetting={},this.shared={config:this._baseClientConfig,transport:this._client?this._client._transport:void 0,emitter:pt,instance:[],collect:{Sentry:[]}},this.baseParams={bid:this.shared.config.commonParams.bid||"",pid:this.shared.config.commonParams.pid||""},this._serverSetting={"cookieid":"d5c95dee-a35d-4d54-9733-09417fdce799","reportDomain":"i.snssdk.com","bid":"clue_nidapp","plugins":{"spa":{"enable":0},"behavior":{"enable":0,"slardar_web_ids":[],"sample_rate":0.1,"download_link":"https://sf1-ttcdn-tos.pstatp.com/obj/ttfe/slardar/plugins/behavior.c5c54dea.js","target_page":"all","patterns":[{"id":0,"match_type":"include"}]},"sentry":{"enable":0,"download_link":"https://sf1-ttcdn-tos.pstatp.com/obj/ttfe/slardar/plugins/sentry.b5bdda24.js","behavior_enable":false,"behavior_sample_rate":0,"behavior_slardar_web_ids":[]}}}},ft=E;if(u()){var dt=new lt;(ft=dt.instance).version=dt.version,ft.shared=dt.shared,ft.SlardarBrowser=lt,ft._baseParams=dt.baseParams,window.Slardar&&window.Slardar.shared&&window.Slardar.shared.instance&&window.Slardar.shared.instance.length?ft=window.Slardar:(window.Slardar&&window.Slardar.q&&(ft.q=window.Slardar.q),window.Slardar&&window.Slardar.i&&(ft.i=window.Slardar.i),window.Slardar=ft)}if(window.Slardar&&window.Slardar.q){var mt=window.Slardar.q;f(mt)&&mt.forEach(function(t){ft.apply(void 0,c(t))}),delete window.Slardar.q}if(window.Slardar&&window.Slardar.i){var _t=window.Slardar.i;f(_t)&&_t.forEach(function(t){var e=vt();if(t.q){var n=t.q;f(n)&&n.forEach(function(t){e.apply(void 0,c(t))}),delete t.q}t.i=e}),delete window.Slardar.i}function vt(){var t=new lt,e=t.instance;return e.version=t.version,e.shared=t.shared,e}return window.Slardar=ft,window.Slardar.SlardarBrowser=lt,window.Slardar.createInstance=vt,ft});
